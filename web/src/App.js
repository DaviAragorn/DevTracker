import React, {useState, useEffect } from 'react';
import api from './services/api'
import WbSunny from '@material-ui/icons/WbSunny';

import './global.scss';
import './App.scss';
import './main.scss';

import DevForm from './components/DevForm'
import DevItem from './components/DevItem'


function App() {
  const [devs, setDevs] = useState([])
  const [theme, setTheme] = useState(true)

  useEffect(() => {
    async function loadDevs(){
      const response = await api.get('/devs')

      setDevs(response.data)
    }

    loadDevs()
  })

  async function handleAddDev(data) {
    const response = await api.post('/devs', data)

    if(response.data){
      setDevs([...devs, response.data])
    }
  }

  function LightSwitch(e){
    e.preventDefault()

    if(theme){
      document.documentElement.setAttribute('data-theme', 'light');
      localStorage.setItem('theme', 'light');
    }
    else{
      document.documentElement.setAttribute('data-theme', 'dark');
      localStorage.setItem('theme', 'dark');
    }
    setTheme(!theme)
  }

  return (
    <div>
      <button type='checkbox' id='switch' onClick={LightSwitch}><WbSunny></WbSunny></button>
      <svg xmlns="http://www.w3.org/2000/svg" id='logo' viewBox="0 0 632.88 115.09"><circle cx="57.54" cy="57.54" r="54.54" fill="none" stroke="#c40a00" stroke-width="6"/><path d="M49.8 66.88l-7.9 19.16 5.14 5.13 11.6-28.84-4.27-4.27L25.5 69.72l5.14 5.14 19.14-7.93M73.86 31.6l-5.14-5.14L57.1 55.3l4.27 4.26 28.85-11.6-5.14-5.14-19.15 7.9 7.92-19.14M30.8 84.65h0l.13-1v-1l-.15-1-.3-1-.45-1-.6-1.06-.73-1.08-.88-1.1-1-1.16-1.2-1.52-2.64-2.6-.68-.7-.55-.6-.4-.53-.28-.45-.15-.36-.06-.3v-.26l.07-.28.17-.35.3-.43.4-.5.55-.58 1.28-1.27-4.26-4.26-2.18 2.18-.94 1-.76 1.08-.57 1.1-.35 1.12-.14 1.14.07 1.14.27 1.13.44 1.1.6 1.1.76 1.12.9 1.1 1 1.08 3.24 3.24.85.86.75.85.64.8.5.76.4.72.25.66.13.6v.57l-.1.55-.23.57-.4.6-1.25 1.42 4.34 4.3L29 90.9l.6-.4.56-.23.56-.1h.56l.6.13.66.26.7.38.77.52.8.64.85.75.9.87 3.24 3.23 1.08 1 1.08.9 1.1.76 1.1.6 1.1.45 1.13.27 1.14.07 1.14-.14 1.12-.35 1.1-.56 1.08-.76 1-.94 2.18-2.2-4.26-4.26-1.17 1.35-.58.55-.5.42-.43.28-.35.17-.28.07h-.26l-.3-.06-.36-.15-.45-.28-.53-.4-.6-.55-.7-.68-2.65-2.64-1.2-1.18-1.16-1-1.12-.88-1.07-.73-1.06-.6-1-.45-1-.3-1-.15h-1l-1 .13M84.9 30.7h0l-.13 1v1l.15 1 .3 1 .44 1 .6 1.06.74 1.07.88 1.12 1 1.16 1.18 1.22L92.74 44l.68.7.54.6.4.53.28.45.15.36.06.3v.26l-.08.28-.16.35-.3.42-.4.5-.56.58-1.27 1.28 4.26 4.26 2.22-1.96.94-1 .76-1.08.56-1.1.36-1.12.14-1.14-.07-1.14-.27-1.13-.45-1.1-.6-1.1-.76-1.1-.94-1.08-1-1.1L94 36.5l-.87-.9-.8-.9-.64-.8-.5-.76-.4-.7-.24-.66-.13-.6v-.56l.1-.56.23-.57.38-.6 1.25-1.42-4.33-4.32-1.43 1.25-.6.4-.57.23-.55.1h-.57l-.6-.13-.66-.26-.7-.4-.8-.52-.8-.64-.85-.75-.9-.87-3.2-3.24-1.1-1-1.08-.9-1.06-.8-1.1-.6-1.1-.45-1.12-.26-1.14-.07-1.14.14-1.1.34-1.1.56-1.07.76-1 .94-2.2 2.2 4.26 4.26 1.28-1.28.58-.55.5-.4.43-.3.35-.17.28-.07h.25l.3.06.37.15.44.28.53.4.62.54.7.68 2.64 2.65 1.22 1.18 1.17 1 1.1.88 1.08.73 1.05.6 1 .45 1 .3 1 .15h1l1-.13m60.06-.87a25.14 25.14 0 0 1 19.23 41.4l-1.44 1.52a24.78 24.78 0 0 1-17.72 7.41h-25.22V29.62zM128.57 71.1h16.2c8.947 0 16.2-7.253 16.2-16.2s-7.253-16.2-16.2-16.2h-16.2zm54.9-27.87v4.68h32.4v9h-32.4v9.5a4.64 4.64 0 0 0 4.6 4.61h36.8v9h-36.8c-7.477-.05-13.507-6.133-13.5-13.6v-23.2a13.57 13.57 0 0 1 13.5-13.6h36.8v9h-36.8a4.64 4.64 0 0 0-4.6 4.61zm94.4-13.6l-4.6 9-21.1 41.4-25.7-50.4h10.13l4.6 9 11 21.6 11-21.6 4.6-9zm51.98.1v9h-20.66v41.4h-9v-41.4H279.5v-9zm45.22 41.38l4.6 9h-10.1l-9.65-18.86a9 9 0 0 0-7.64-4.32h-9V80.1h-9V29.72h31.83a13.51 13.51 0 0 1 9.58 4 13.82 13.82 0 0 1 4 9.65 13.65 13.65 0 0 1-7.95 12.35 11.86 11.86 0 0 1-3.89 1zm-8.93-23.18a4.27 4.27 0 0 0 1.87-.43 4.58 4.58 0 0 0 2.74-4.18 4.74 4.74 0 0 0-1.37-3.31 4.54 4.54 0 0 0-3.24-1.3H343.3V48zm66.68 32.1h-10.1l-4.6-9-11-21.6-15.6 30.6h-10.1l4.6-9 21.1-41.4 21.1 41.4zm3.52-25.2a16.22 16.22 0 0 0 16.25 16.2h25.2v9h-25.2c-13.918 0-25.2-11.282-25.2-25.2s11.282-25.2 25.2-25.2h25.2v9h-25.2a16.22 16.22 0 0 0-16.25 16.2zm74.25-4.97l21.8 30.17h-11.1l-17.43-24-12.74 11.54v12.46h-9v-50.4h9V55.4l7.46-6.77 6.7-6.12 14-12.9h13.3zm31.15-6.62v4.68h32.4v9h-32.4v9.5a4.64 4.64 0 0 0 4.61 4.61h36.8v9h-36.8a13.58 13.58 0 0 1-13.54-13.6v-23.2c-.017-7.496 6.044-13.588 13.54-13.6h36.8v9h-36.8a4.64 4.64 0 0 0-4.61 4.61zm86.55 27.87l4.6 9H622.8l-9.65-18.86a8.93 8.93 0 0 0-7.58-4.32h-9V80.1h-9V29.72h31.83a13.49 13.49 0 0 1 9.58 4 13.68 13.68 0 0 1-4 22 11.86 11.86 0 0 1-3.91 1zm-8.93-23.18a4.27 4.27 0 0 0 1.87-.43 4.58 4.58 0 0 0 2.74-4.18 4.7 4.7 0 0 0-1.38-3.31 4.5 4.5 0 0 0-3.24-1.3h-22.76V48z" fill="#c40a00"/></svg>
      <div id="app">
        <aside>
          <strong>Sign Up</strong>
          <DevForm onSubmit={handleAddDev}/>
        </aside>
        <main>
          <ul>
            {devs.map(dev => (
              <DevItem key={dev._id} dev={dev} />
            ))}
          </ul>
        </main>
      </div>
    </div>
  );
}

export default App;
